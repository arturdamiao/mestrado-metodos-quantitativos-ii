---
title: "Replicação: A redução da maioridade penal diminui a violência? Evidências de um estudo comparado"
format: 
  html: 
    toc: true
    toc-depth: 2
    toc-location: left
    toc-title: "Sumário"
    

author: 
  - name: Artur Damião
    email: arturcardoso@usp.br
    orcid: 0000-0002-8628-1653

date: today
date-format: "long"
number-sections: true

lang: pt

embed-resources: true

execute: 
  warning: false
---

# Ambientação {.unnumbered}

```{r}
pacman::p_load(
  tidyverse,
  janitor,
  stargazer,
  rio,
  data.table,
  lmtest,
  sandwich,
  performance
)
```

## Dados {.unnumbered}

Lendo a base de dados direto do Github

```{r}
link <- "https://github.com/mgaldino/lab-regressao-aula/blob/main/trabalho%20final/4Lins_2016/maioridade.tab?raw=true"

df <- readRDS("../dados/maioridade-replicacao.rds")
```

Transformando as variáveis 

```{r}
df <- df %>% 
  janitor::clean_names() %>% 
  dplyr::mutate(
    acr_cipriani = ifelse(acr_cipriani == 999, NA, acr_cipriani)
    )
```


# Hipóteses

O objetivo dos autores é testar a hipótese de que quanto menor a maioridade penal, menor o nível de violência. A @eq-regressao apresenta o modelo estimado: 

$$
Y = \alpha + \beta_1X_1 + \beta_2X_2 + \beta_3X_3 + \beta_4X_4 + \epsilon
$$ {#eq-regressao}

Onde, 

$Y$: Taxa de Homicídio por 100 mil habitantes (`homi_rate_unodc`)

$X_1$: Idade de Maioridade Penal ou Responsabilidade Criminal (`acm_hazel`, `acm_gv`, `acr_hazel` ou `acr_cipriani`)

$X_2$: Índice de Desenvolvimento Humano (`idh`)

$X_3$: Índice Gini (`ginmar_solt`)

$X_4$: Desemprego de longo termo (`desemprego_longo`)

Criando os modelos

```{r}
modelo_acm_hazel <- lm(homi_rate_unodc ~ acm_hazel + idh + desemprego_longo + ginmar_solt,
                       data = df)

modelo_acm_gv <- lm(homi_rate_unodc ~ acm_gv + idh + desemprego_longo + ginmar_solt,
                       data = df)

modelo_acr_hazel <- lm(homi_rate_unodc ~ acr_hazel + idh + desemprego_longo + ginmar_solt,
                       data = df)

modelo_acr_cipriani <- lm(homi_rate_unodc ~ acr_cipriani + idh + desemprego_longo + ginmar_solt,
                       data = df)
```

Apresentando os modelos
```{r}
stargazer::stargazer(modelo_acm_hazel, modelo_acm_gv, modelo_acr_hazel, modelo_acr_cipriani,
                     type = "text",
                     title = "Resultados das Regressões",
                     style = "ajps")
```

# Analisando o erro padrão robusto

## ACM_HAZEl

```{r}
coeftest(modelo_acm_hazel, vcov = vcovHC(modelo_acm_hazel, type = "HC3"))
```

## ACM_GV

```{r}
coeftest(modelo_acm_gv, vcov = vcovHC(modelo_acm_gv, type = "HC3"))
```

## ACR_HAZEL

```{r}
coeftest(modelo_acr_hazel, vcov = vcovHC(modelo_acr_hazel, type = "HC3"))
```

## ACR_CIPRIANI

```{r}
coeftest(modelo_acr_cipriani, vcov = vcovHC(modelo_acr_cipriani, type = "HC3"))
```

